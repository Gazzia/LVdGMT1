chance={isShown:!1,show(){chance.isShown||(overlay.show("testDark"),this.isShown=!0,$(".chance").css({display:"block",animation:"open-modal 0.3s ease forwards"})),delay(function(){dice.show()},400)},hide(){chance.isShown&&($(".chance").css("animation","close-modal 0.3s ease forwards"),delay(function(){$(".chance").css("display","none"),overlay.hide(),chance.isShown=!1},300))},init(e){if(this.consq=e.consq,"difficulté"==e.type)var t=e.diff;e.type;var i={EcCr:[1,Math.round(t/3*20)-1],Ec:[Math.round(t/3*20),Math.round(20*t)-1],"Ré":[Math.round(20*t),Math.round(20*(t+(1-t)/3*2))-1],"RéCr":[Math.round(20*(t+(1-t)/3*2)),20]},s={EcCr:[],Ec:[],"Ré":[],"RéCr":[]};s.Ec=i.Ec,s.Ré=i.Ré,i.EcCr[1]<=1?i.Ec[0]<=1?(s.EcCr=!1,s.Ec[0]=1):s.EcCr=1:s.EcCr=i.EcCr,20<=i.RéCr[0]?20<=i.Ré[1]?(s.RéCr=!1,s.Ré[1]=20):i.Ré[1]<=i.Ré[0]&&20<=i.Ré[0]?s.RéCr=!1:s.RéCr=20:s.RéCr=i.RéCr,i.Ec[1]<=i.Ec[0]&&(s.Ec=i.Ec[0]),i.Ré[1]<=i.Ré[0]&&(s.Ré=i.Ré[0]),chance.resultGrid=s,$(".chance aside").html("");var a=chance.resultGrid,r=[a.EcCr,a.Ec,a.Ré,a.RéCr],o=["Échec critique","Échec","Réussite","Réussite critique"],n=["EcCr","Ec","Ré","RéCr"];for(let e in r)r[e]&&("number"==typeof r[e]&&$(".chance aside").append(`<div class='${n[e]} cat'><h2>${o[e]}</h2>${r[e]}`),"object"==typeof r[e]&&$(".chance aside").append(`<div class='${n[e]} cat'><h2>${o[e]}</h2>${r[e][0]} à ${r[e][1]}`));chance.show()},getResult(e){var t,i,s,a=chance.resultGrid,r={list:[a.EcCr,a.Ec,a.Ré,a.RéCr],txt:["Échec critique","Échec","Réussite","Réussite critique"],names:["EcCr","Ec","Ré","RéCr"]};for(cat in r.list)r.list[cat]&&("number"==typeof r.list[cat]&&e==r.list[cat]&&(t=r.txt[cat],i=r.names[cat]),"object"==typeof r.list[cat]&&r.list[cat][0]<=e&&e<=r.list[cat][1]&&(t=r.txt[cat],i=r.names[cat]));$(`.chance aside .${i}`).css("animation","chanceCatShine 3s ease forwards"),$(`.chance aside .${i} h2`).css("animation","chanceCatShine_h2 3s ease forwards"),s=chance.consq[i].txt?`<br> <i>${chance.consq[i].txt}`:"",new Notification({type:`test-${i}`,txt:`Test de chance : ${t}! ${s}`,timeOut:80}),delay(function(){chance.consq[i].script&&chance.consq[i].script()},500),delay(function(){chance.hide()},3e3)}};class Civil{constructor(e={}){this.money={total:e.money||0,add:function(e){this.total+=e},log(){this.total.toMoney().cuivre&&console.log(`${this.total.toMoney().cuivre} cuivre`),this.total.toMoney().argent&&console.log(`${this.total.toMoney().argent} argent`),this.total.toMoney().or&&console.log(`${this.total.toMoney().or} or`)}},this.name=e.name||"Gilbert",this.race=e.race||"Angulain",this.inv=new Inventory(this),this.genre=e.genre||"m",this.health={showNotifs:!1,max:e.healthmax||100,current:e.healthmax||100,change(e){if(e.remove){if("max"==e.from)return this.max-e.remove>0?(this.max-=e.remove,this.showNotifs&&new Notification({type:"health",txt:`Votre vie maximum a été réduite de ${e.remove} pts!`,timeOut:30})):(this.max=0,this.die()),this.max<this.current&&(this.current=this.max),this.max;if("current"==e.from)return this.current-e.remove>0?(this.current-=e.remove,this.showNotifs&&new Notification({type:"health",txt:`Votre vie a diminué de ${e.remove} pts!`,timeOut:30})):this.current=0,this.current;0==this.current&&this.showNotifs&&this.die()}else if(e.add){if("max"==e.from)return this.max+=e.add,this.showNotifs&&new Notification({type:"health",txt:`Votre vie maximum a été augmentée de ${e.add} pts!`,timeOut:30}),this.max;if("current"==e.from)return this.current+e.add>=this.max?this.heal():(this.current+=e.add,this.showNotifs&&new Notification({type:"health",txt:`Votre vie a été regénérée de ${e.add} pts!`,timeOut:30})),this.current}},heal(){this.current=this.max,this.showNotifs&&new Notification({type:"health",txt:"Votre vie a été complêtement regénérée !",timeOut:30})},die(){this.showNotifs&&new Notification({type:"error",txt:"Vous êtes mort ! (Enfin théoriquement)",timeOut:!1})}}}}class NPC extends Civil{constructor(e={}){super(e),NPC.instances.push(this)}}NPC.instances=[];class Player extends Civil{constructor(e={}){super(e),this.money.add=function(e){this.total+=e,new Notification({type:"gold",txt:`Votre richesse a augmenté de ${e.money_phrase()}!`,timeOut:15})},this.health.showNotifs=!0}}var dice={throws:0,launch(){var e=document.getElementById("cube");dice.result=random(1,20),e.className="show-"+random(1,20),delay(function(){e.className="show-"+random(1,20),delay(function(){e.className="show-"+random(1,20),delay(function(){e.className="show-"+dice.result,delay(function(){chance.getResult(dice.result)},500)},400)},400)},400)},show(){document.getElementById("cube").className="show-10",$("#d20").css({display:"inline-block",animation:"fadeIn 0.3s ease forwards"}).on("click",function(){dice.launch(),$("#d20").off()})},hide(){$("#d20").css("animation","fadeOut 0.3s ease forwards"),delay(function(){$("#d20").css("display","none")},300)}},Events={helper_btnBlockOnModal:!1,tookbaton:!1,"HaltsAtRivière":0,"rivièreTraversée":!1},extrasDB={time:{long_soufflant(){(0==time.daysPlayed&&"nuit"==time.period||1==time.daysPlayed&&time.hours<=4)&&extraBlock("Le soleil est déjà couché, et vous ne voyez plus grand chose.. peut-être serait-il temps de se hâter vers Merryvale ?","time"),1==time.daysPlayed&&"nuit"!=time.period&&extraBlock("Cela fait déjà un jour entier que vous êtes dans la plaine.. Ne serait-il pas une bonne idée d'essayer d'atteindre Merryvale ?","time"),(1==time.daysPlayed&&time.hours>=21||time.daysPlayed>1)&&extraBlock("Cela fait beaucoup trop longtemps que vous êtes ici. Vous n'êtes plus derrière l'écran ? Ouu vous avez eu un problème ? Je dois appeler les urgences ?","time")}}},game={pageID:0,page:{},scene:{},loadPage:function(e){game.pageID=e,game.page=new Page(pageList[e]),game.scene=game.page.scenes[game.page.sceneID-1],$("main .textbox.title").html(game.page.title.format()),$("main .textbox.scene").html(game.page.fluff.format()),$("main .extrasContainer").html(""),$("main .textbox.story").html(game.scene.story().format()),game.scene.extras(),game.page.refBackground()},refreshPage:function(){game.scene=game.page.scenes[game.page.sceneID-1],$("main .textbox.title").html(game.page.title.format()),$("main .textbox.scene").html(game.page.fluff.format()),$("main .extrasContainer").html(""),$("main .textbox.story").html(game.scene.story().format()),game.scene.extras(),game.page.refBackground()},ui:{isHidden:!1,show(){$("main.main").css("animation","show-ui-main 0.6s ease forwards"),$("nav.gameMenu").css("animation","show-ui-nav 0.6s ease forwards"),this.isHidden=!1},hide(){$("main.main").css("animation","hide-ui-main 0.6s ease forwards"),$("nav.gameMenu").css("animation","hide-ui-nav 0.6s ease forwards"),this.isHidden=!0},toggle(){this.isHidden?this.show():this.hide()}}};class Inventory{constructor(e){this.owner=e,this.maxWeight=9,this._itemList=[],this.sum=function(e,t){return e.reduce(function(e,i){return e+i[t]},0)}}get list(){return this._itemList.sort()}log(){console.log("%cInventaire de "+this.owner.name+" ("+this.owner.constructor.name+")","font-weight: bold; color:blue;"),console.table(this._itemList)}get totalWeight(){return this.sum(this._itemList,"poids")}hasSpaceFor(e){return this.totalWeight+e.poids<=this.maxWeight}find(e){return this._itemList.find(t=>t.name===e)}add(e){var t=itemList.find(e);if(t&&this.hasSpaceFor(t)){if("Player"==this.owner.constructor.name){var i,s;switch(t.type){case"Arme":i="Nouvelle arme",s=[{txt:"Equipper",blockOnModal:!0,script(){}},{txt:"Inventaire",blockOnModal:!0,script(){}}];break;default:i="Nouvel objet",s=!1}new Notification({type:"inv",timeOut:!1,btns:s,txt:`${i} : ${e} !`})}return this._itemList.push(t),!0}return t?("Player"==this.owner.constructor.name&&new Notification({type:"error",timeOut:!1,txt:`Vous n'avez pas assez de place dans votre inventaire pour : ${e} !`}),console.warn(e+": pas assez de place dans l'inventaire de "+this.owner.name+" ("+this.owner.constructor.name+")"),!1):(console.error(e+": objet inexistant"),!1)}remove(e){var t=itemList.find(e),i=this.find(e);t&&i?this._itemList.splice(this._itemList.indexOf(t),1):t?console.warn(e+": il n'y en a pas dans l'inventaire de "+this.owner.name+" ("+this.owner.constructor.name+")"):console.error(e+": objet inexistant")}give(e,t){}}const itemList={find:e=>itemList.list.find(t=>t.name===e),type:e=>itemList.list.filter(t=>t.type===e),log:{ol(){for(type of["Arme","Divers","Bouffe"])console.log("%c"+type,"font-weight: bold;"),console.table(itemList.type(type))},ul(){console.table(itemList.list)}},list:[{name:"Branche",type:"Arme",poids:5},{name:"Epée",type:"Arme",poids:7}]};var modal={isOpen:!1,buttons:[],load(e={}){this.isOpen?this.switch(e):this.fadeIn(e)},fadeIn(e){this.isOpen=!0,modal.apply(e),overlay.show(),$(".modal").css({animation:"open-modal .7s cubic-bezier(.16, .81, .32, 1) forwards",display:"block"}),this.img&&delay(function(){$(".modal").css("animation","adapt-modal 0.4s ease forwards")},700)},switch(e){$(".modal").css("animation","switch-modal-hide 0.4s ease-in forwards"),delay(function(){modal.apply(e),$(".modal").css("animation","switch-modal-show 0.4s ease-out forwards")},400)},close(e={}){this.isOpen=!1,e.keepOverlay||overlay.hide(),$(".modal").css("animation","close-modal .5s ease")},apply(e){switch(this.img=e.img||0,this.title=e.title.format()||"Pas de titre",this.txt=e.txt.format()||"Pas de texte",this.btnColor=0,e.color){case"salmon":this.color="rgb(239, 137, 119)",this.btnColor="rgb(238, 122, 102)";break;case"wine":this.color="#87475b";break;case"faded":this.color="#6d6875";break;case"aqua":this.color="rgb(52, 118, 122)";break;default:this.color="rgb(167, 113, 103)",this.btnColor="rgb(167, 113, 103)"}for(btn in this.btnColor||(this.btnColor=this.color),this.img&&"0"!=this.img?$(".modal").addClass("withImage"):$(".modal").removeClass("withImage"),$(".modal header").html(this.title).css("background-color",this.color),$(".modal main .txt").html(this.txt),$(".modal .img").css({"background-image":`url('../assets/img/modal/${this.img}.png')`,"border-top-color":this.color}),$(".modal main .btns").html(""),e.buttons&&(modal.buttons=e.buttons),modal.buttons)$(".modal main .btns").append(`<div class='btn' onclick='modal.buttons[${btn}].script()'>${modal.buttons[btn].title.format()}</div>`);$(".modal main .btns .btn").css("background-color",this.btnColor)}},modalList={devModalBtns:[{title:"<i>modalColor</i> - faded",script(){modalList.devModal("faded")}},{title:"<i>modalColor</i> - aqua",script(){modalList.devModal("aqua")}},{title:"<i>modalColor</i> - wine",script(){modalList.devModal("wine")}},{title:"<i>modalColor</i> - salmon",script(){modalList.devModal("salmon")}},{title:"<i>modalColor</i> - normal",script(){modalList.devModal("normal")}},{title:"<i>TIME</i> - Journée",script(){time.set({hours:12})}},{title:"<i>TIME</i> - Aube",script(){time.set({hours:6})}},{title:"<i>TIME</i> - Crépuscule",script(){time.set({hours:18})}},{title:"<i>TIME</i> - Nuit",script(){time.set({hours:23})}},{title:"<i>TIME</i> - days played +1",script(){++time.daysPlayed,game.refreshPage()}},{title:"<i>NOTIF</i> - sample",script(){new Notification({timeOut:15,type:"error"}),delay(function(){new Notification({timeOut:15,type:"success"}),delay(function(){new Notification({timeOut:15,type:""}),delay(function(){new Notification({timeOut:15,type:"magic"}),delay(function(){new Notification({timeOut:15,type:"inv"}),delay(function(){new Notification({timeOut:15,type:"gold"}),delay(function(){new Notification({timeOut:15,type:"health"}),delay(function(){new Notification({timeOut:15,type:"test-EcCr"}),delay(function(){new Notification({timeOut:15,type:"test-Ec"}),delay(function(){new Notification({timeOut:15,type:"test-Ré"}),delay(function(){new Notification({timeOut:15,type:"test-RéCr"})},500)},500)},500)},500)},500)},500)},500)},500)},500)},500)}},{title:"Quitter le modal",script(){modal.close()}}],devModal(e){modal.load({title:"Modal de développement",txt:"Actions:",color:e,buttons:modalList.devModalBtns})},Soufflant_Embranchement_RegarderBois(){modal.load({title:"Bois",txt:"La présence de ce petit bois est opportune : il fait très chaud dans la plaine, qui est d'ordinaire plutôt dépourvue d'arbres. Les premiers arbres se situent à une minute de marche, et leur ombre vous fera sûrement le plus grand bien.",color:0,img:0,buttons:[{title:"Ok",script(){modal.close()}}]})},Soufflant_Embranchement_RegarderCabane(){var e;switch(time.période){case"nuit":e="Vous ne pouvez pas distinguer clairement l'édifice d'aussi loin et dans le noir, mieux vaut s'approcher.";break;default:e="L'édifice s'élève sur une colline voisine, mais vous ne distinguez pas grand chose d'aussi loin."}modal.load({title:"Cabane",txt:e,color:0,img:0,buttons:[{title:"Ok",script(){modal.close()}}]})},Soufflant_Bois_RegarderSol(){0==Events.tookbaton?modal.load({title:"Sol",txt:"Vous apercevez à terre une belle branche qui pourrait vous servir d'arme rudimentaire.<br>\n\t\t\t\tVoulez-vous la prendre ?",color:0,img:0,buttons:[{title:"Prendre",script(){1==player.inv.add("Branche")?(game.page.refBackground(),modal.close()):modal.close()}},{title:"Partir",script(){modal.close()}}]}):modal.load({title:"Sol",txt:"Le sol est jonché de vieilles brindilles et de feuilles.",color:0,img:0,buttons:[{title:"Partir",script(){modal.close()}}]})},Soufflant_Riviere_RegarderEau(){modal.load({title:"Dans l'onde fraîche",txt:"Le petit bras d'eau est plein de vie -et plein d'eau ! L'endroit est très tranquille et serait propice à une petite halte.",color:"wine",img:"rivewater",buttons:[{title:"Faire une petite halte",script(){modal.close(),game.ui.hide(),Events.HaltsAtRivière++,delay(function(){modalList.Soufflant_Riviere_HalteFinie()},2e4)}},{title:"Pas le temps !",script(){modal.close()}}]})},Soufflant_Riviere_HalteFinie(){modal.load({title:"Super",txt:"Cette petite halte est vraiment très agréable. Repartons maintenant.",color:"wine",img:"rivewater",buttons:[{title:"Non",script(){modal.close(),game.ui.hide(),3==++Events.HaltsAtRivière&&new Notification({type:"magic",timeOut:"30",txt:"Ce petit moment de répit vous a fait du bien, votre vie a été régénérée."}),delay(function(){modalList.Soufflant_Riviere_HalteFinie()},14e3)}},{title:"Partir",script(){Events.HaltsAtRivière=0,modal.close(),game.ui.show()}}]})},Soufflant_Riviere_LookRive(){modal.load({title:"De l'autre côté des flots",txt:"Sur l'autre rive, vous apercevez un peu plus en aval ce qui semble être une bourse de pièces au pied d'un arbre..",img:"rivewater",buttons:[{title:"Traverser",script(){chance.init({type:"difficulté",diff:.35,consq:{EcCr:{txt:"En essayant de traverser le bras d'eau, votre pied glisse et vous tombez la tête la première sur un rocher.<br>A moitié assommé{f:e} et le front en sang, vous arrivez sur l'autre rive pour découvrir une bourse vide.",script:function(){player.health.change({from:"current",remove:20})}},Ec:{txt:"Vous traversez le bras d'eau sans encombre, mais en arrivant sur l'autre rive trempé{f:e} jusqu'aux os, vous découvrez la bourse complêtement vide."},"Ré":{txt:"Vous traversez le bras d'eau sans encombre, et en arrivant sur l'autre rive tout{f:e} trempé{f:e}, vous êtes récompensé{f:e} en trouvant dans la bourse quelques lunes d'argent et de cuivre.",script:function(){player.money.add(515)}},"RéCr":{txt:"Vous traversez le bras d'eau aisément, et trouvez dans la bourse, sur l'autre rive, une jolie somme en lunes d'argent et de cuivre !",script:function(){player.money.add(1504)}}}}),Events.rivièreTraversée=!0,modal.close({keepOverlay:!0})}},{title:"Partir",script(){modal.close()}}]})},"Soufflant_Riviere_LookRive_Traversée"(){modal.load({title:"De l'autre côté des flots",txt:"Vous venez de traverser les eaux à vos risques et périls, et vous ne voulez plus recommencer. D'ailleurs, il n'y aurait rien dans la bourse en face.",img:"rivewater",buttons:[{title:"Partir",script(){modal.close()}}]})},Soufflant_Riviere_LookInsectes(){modal.load({title:"Un essaim de lumière",txt:"Les bégariannes sont des insectes volants très étranges, capables de produire autour d'eux, la nuit, un halo de jour large comme la main. Leurs proches cousins, les négariannes, produisent l'effet inverse : on les repère facilement le jour, car elles émettent un halo de nuit autour d'elles.",img:!1,buttons:[{title:"Ok",script(){modal.close()}},{title:"Essayer d'en attraper",script(){modal.close()}}]})}};function Notification(e={}){switch(this.type=e.type||"normal",this.type){case"error":var t={from:"#d44d2b",to:"#e92e2e"},i="white",s="Erreur",a="notif-error.svg";break;case"success":t={from:"#5acf9c",to:"#43bc4c"},i="white",s="Succès",a=!1;break;case"magic":t={from:"rgb(142, 115, 236)",to:"rgb(182, 93, 80)"},i="white",s="Magie",a="notif-magic.svg";break;case"inv":t={from:"rgb(236, 152, 115)",to:"rgb(182, 93, 80)"},i="white",s="Nouvel objet",a="notif-inv.svg";break;case"gold":t={from:"rgb(212, 204, 72)",to:"rgb(182, 93, 80)"},i="white",s="Transaction",a="coin.svg";break;case"test-EcCr":t={from:"rgb(100, 35, 35)",to:"rgb(147, 58, 51)"},i="white",s="Test de chance - Echec critique",a="notif-d20.svg";break;case"test-Ec":t={from:"rgb(190, 141, 82)",to:"rgb(147, 58, 51)"},i="white",s="Test de chance - Echec",a="notif-d20.svg";break;case"test-Ré":t={from:"rgb(103, 200, 157)",to:"rgb(51, 147, 113)"},i="white",s="Test de chance - Réussite",a="notif-d20.svg";break;case"test-RéCr":t={from:"rgb(155, 200, 103)",to:"rgb(51, 147, 113)"},i="white",s="Test de chance - Réussite critique",a="notif-d20.svg";break;case"health":t={from:"rgb(212, 43, 171)",to:"rgb(218, 140, 153)"},i="white",s="Santé",a="notif-health.svg";break;default:t={from:"#5acecf",to:"#4350bc"},i="white",s="Information",a="notif-info.svg"}if(this.txt=(e.txt||s).format(),this.btns=e.btns||0,e.closable||!1===e.closable?this.closable=e.closable:this.closable=!0,e.timeOut||0==e.timeOut?this.timeOut=e.timeOut:this.timeOut=5,this.element=$(`<div class="notif"><div class="icon"></div>${this.txt}<div class="btns"></div></div>`),$(".notifications").prepend(this.element),this.element.css({backgroundImage:`linear-gradient(162deg, ${t.from}, ${t.to})`,color:i,animation:"fadeInNotif 0.3s ease-in forwards"}),a&&(this.element.children(".icon").css("background-image",`url("../assets/img/ui/${a}")`),this.element.css("padding-left","2vw")),this.closable&&($closeBtn=$('<div class="close">'),this.element.append($closeBtn).css("padding-right","2vw"),$closeBtn.on("click",function(){this.closeNotif()}.bind(this))),this.btns)for(btn of this.btns)btn.element=$('<div class="btn">'),btn.parent=this,this.element.children(".btns").append(btn.element.text(btn.txt).on("click",function(){!this.blockOnModal||this.blockOnModal&&!modal.isOpen&&!chance.isShown?this.script().bind(this):(this.element.css("background-color","#b24e4e"),delay(function(){this.element.css("background-color",""),delay(function(){Events.helper_btnBlockOnModal||(new Notification({txt:"Lorsqu'un bouton de notification clignote rouge une fois cliqué, c'est que sa fonction est interdite dans le contexte actuel (évènement, modal, etc..), mais sera réactivée dès ce contexte terminé.",timeOut:20}),Events.helper_btnBlockOnModal=!0)}.bind(this),400)}.bind(this),300))}.bind(btn)));0!=this.timeOut&&(this.element.append('<div class="progressBar"><div class="progress">'),delay(function(){this.element.children(".progressBar").children(".progress").css("animation","progressDecrease "+this.timeOut+"s linear forwards"),delay(function(){this.closeNotif()}.bind(this),1e3*this.timeOut)}.bind(this),500)),this.closeNotif=function(){this.element.css("animation","fadeOutNotif 0.4s ease-out forwards"),delay(function(){this.element.remove();var e=Notification.instances.indexOf(this);e>-1&&Notification.instances.splice(e,1)}.bind(this),400)},Notification.instances.unshift(this)}Notification.instances=[],Number.prototype.money_convert=function(){return{or:Math.floor(this/1e4),argent:Math.floor(this/100)%100,cuivre:this%100}},Number.prototype.money_verbose=function(){var e=[],t=this.money_convert();return t.or&&(t.or>1&&e.push(`${t.or} lunes d'or`),1==t.or&&e.push(`${t.or} lune d'or`)),t.argent&&(t.argent>1&&e.push(`${t.argent} lunes d'argent`),1==t.argent&&e.push(`${t.argent} lune d'argent`)),t.cuivre&&(t.cuivre>1&&e.push(`${t.cuivre} lunes de cuivre`),1==t.cuivre&&e.push(`${t.cuivre} lune de cuivre`)),e},Number.prototype.money_iconize=function(){var e=[],t=this.money_convert();return t.or&&(t.or>1&&e.push(`${t.or}<div class="coinIcon or"></div>`),1==t.or&&e.push(`${t.or}<div class="coinIcon or"></div>`)),t.argent&&(t.argent>1&&e.push(`${t.argent}<div class="coinIcon argent"></div>`),1==t.argent&&e.push(`${t.argent}<div class="coinIcon argent"></div>`)),t.cuivre&&(t.cuivre>1&&e.push(`${t.cuivre}<div class="coinIcon cuivre"></div>`),1==t.cuivre&&e.push(`${t.cuivre}<div class="coinIcon cuivre"></div>`)),e},Number.prototype.money_phrase=function(){var e=this.money_verbose(),t="";for(moneyType in e)t+=e[moneyType],moneyType<e.length-1&&(3==e.length&&0==moneyType?t+=", ":t+=" et ");return""==t&&(t="Pas d'argent"),t},Number.prototype.money_icons=function(){var e=this.money_iconize(),t="";for(moneyType in e)t+=e[moneyType],moneyType<e.length-1&&(t+=" ");return""==t&&(t="0 <div class='coinIcon cuivre'></div>"),t};var overlay={isShown:!1,show(e=0){e?"testDark"==e&&$(".overlay").css("background-color","rgba(49, 35, 17, 0.8)"):$(".overlay").css("background-color","rgba(61, 49, 25, 0.4)"),this.isShown||($(".overlay").css({animation:"fadeIn .5s ease forwards",display:"block"}),this.isShown=!0)},hide(){this.isShown&&($(".overlay").css("animation","fadeOut .5s ease forwards"),this.isShown=!1,delay(function(){$(".modal, .overlay").css("display","none")},500))}};function Page(e){this.sceneID=e.sceneID||1,this.title=e.title,this.fluff=e.fluff,this.scenes=e.scenes,this.changeScene=function(e){this.sceneID=e,game.refreshPage()},this.refBackground=e.refBackground}function extraBlock(e,t){t?$("main .extrasContainer").append(`<div class='textbox extra hasimg'><div class='img' style='background-image:url("../assets/img/extraIcons/${t}.png")'></div>${e.format()}</div>`):$("main .extrasContainer").append(`<div class='textbox extra'>${e.format()}</div>`)}function applyBackground(e){$(".background .prop.object").css("background-image","none"),e.back?$(".cover.-back").css("background-image",`url("../assets/img/bg/full/${e.back}.png")`):$(".cover.-back").css("background-image","none"),e.mid?$(".cover.-mid").css("background-image",`url("../assets/img/bg/full/${e.mid}.png")`):$(".cover.-mid").css("background-image","none"),e.fore?$(".cover.-fore").css({"background-image":`url("../assets/img/bg/full/${e.fore}.png")`,"background-position":e.fore_pos}):$(".cover.-fore").css("background-image","none")}var pageList=[{title:"Errance",fluff:"Vous voilà planté{f:e} au coeur de la plaine du Soufflant.//\n    Malgré son nom, la plaine est chaude l'été mais pas la moindre brise ne se fait ressentir.",refBackground:function(){applyBackground({fore:"Soufflant_Plaine_Embranchement_fore_day",fore_pos:"right",mid:"Soufflant_Plaine_Embranchement_mid_day",back:"Soufflant_Plaine_Embranchement_back_day"})},scenes:[{story:()=>"journée"==time.period?"Les sauterelles chantent sous le ciel d'azur.//\n\t\t\t\t\tVous êtes trempé{f:e} de sueur et l'atmosphère devient de plus en plus lourde..//\n\t\t          En regardant vers l'Ouest, vous apercevez {c:un petit bois|wood} où vous pourrez vous rafraîchir.//\n\t\t          Vers l'Est, {c:une petite cabane en bois|cabane} se dresse sur une colline.//\n\t\t          Au Nord, {c:le chemin de terre|chemin} continue et serpente vers un vallon.":"crépuscule"==time.period?"Le nuit tombe et la température redescend lentement, mais l'atmosphère continue tout de même à s'allourdir de minutes en minutes.//\n\t\t          Vers l'Ouest se trouve {c:un petit bois|wood}, dont les ombres s'allongent de minute en minute.//\n\t\t          Vers l'Est, {c:une petite cabane en bois|cabane} se dresse sur une colline.//\n\t\t          Au Nord, {c:le chemin de terre|chemin} continue et serpente vers le soleil couchant.":"nuit"==time.period?"La nuit est tombée mais l'atmosphère continue tout de même à s'allourdir de minutes en minutes.//\n\t\t          Vous ne distinguez pas grand-chose, seulement que vers l'Ouest se trouve {c:un petit bois obscur|wood}.\n\t\t          Vers l'Est, {c:l'ombre d'une cabane|cabane} se dresse sur une colline.//\n\t\t          Au Nord, {c:le chemin|chemin} continue et serpente dans l'obscurité.":"aube"==time.period?"Le jour se lève lentement, avec la même sensation pesante dans l'atmosphère.//\n\t\t          Vers l'Ouest se trouve {c:un petit bois|wood}, dont les ombres s'allongent de minute en minute.//\n\t\t          Vers l'Est, {c:une petite cabane en bois|cabane} se dresse sur une colline.//\n\t\t          Au Nord, {c:le chemin de terre|chemin} continue et serpente vers le soleil couchant.":void 0,extras(){extrasDB.time.long_soufflant()},triggers:[{trigText:"wood",showName:"le petit bois",RClick:function(){game.loadPage(1)},actions:[{name:"Regarder",style:"normal",script(){modalList.Soufflant_Embranchement_RegarderBois()}},{name:"Y aller",style:"rightClick",script(){game.loadPage(1)}}]},{trigText:"cabane",showName:"la cabane",actions:[{name:"Regarder",style:"normal",script(){modalList.Soufflant_Embranchement_RegarderCabane()}},{name:"S'approcher",style:"rightClick",script(){}}]},{trigText:"chemin",showName:"le chemin",actions:[{name:"Continuer",style:"rightClick",script(){}}]}]}]},{title:"Une fraîcheur bien méritée",fluff:"Vous voilà à l'entrée d'un petit bois de cérembles.",refBackground:function(){applyBackground({mid:"Soufflant_Plaine_Bois_mid",fore:"Soufflant_Plaine_Bois_fore",fore_pos:"center"}),0==Events.tookbaton&&$(".background .prop.object").css({backgroundImage:'url("../assets/img/bg/prop/baton.png")',height:"13vh",width:"11vw",left:"15vw",bottom:"5vh"})},scenes:[{story:()=>"journée"==time.period?"De l'ombre ! Enfin !//\n\t\t\t\t\t\tVous vous apprêtez à vous asseoir {c:dans l'herbe|sol} au pied d'un jeune tronc, quand vous entendez {c:un bruit|bruit} : une eau qui s'enfuit un peu plus loin.":"crépuscule"==time.period?"Vous vous apprêtez à vous reposer quelques minutes {c:dans l'herbe |sol}, parmis les ombres allongeantes. Cependant, {c:un bruit|bruit} vous interpelle : le murmure d'une eau qui s'enfuit plus loin.":"nuit"==time.period?"Vous ne distinguez pas grand chose dans le chaos d'ombres des arbres. Cependant, {c:un bruissement|bruit} vous interpelle : le murmure d'une eau qui s'enfuit plus loin.":"aube"==time.period?"Les arbres se colorent lentement avec le soleil naissant.//\n\t\t\t\t\tPasser toute une nuit debout dans la plaine était exténuant : vous vous apprêtez à vous reposer quelques minutes {c:par terre|sol}. Cependant, {c:un bruissement|bruit} vous interpelle : le murmure d'une eau qui s'enfuit plus loin.":void 0,extras(){extraBlock("Vous vous êtes légèrement écarté{f:e} du {c:sentier}","path"),extrasDB.time.long_soufflant()},triggers:[{trigText:"sol",showName:"le sol du bois",actions:[{name:"Inspecter",style:"normal",script(){modalList.Soufflant_Bois_RegarderSol()}}]},{trigText:"bruit",showName:"le bruit d'eau",RClick:function(){game.loadPage(2)},actions:[{name:"Regarder",style:"normal",script(){}},{name:"Suivre le bruit",style:"rightClick",script(){game.loadPage(2)}}]},{trigText:"sentier",showName:"le chemin",RClick:function(){game.loadPage(0)},actions:[{name:"Revenir sur le chemin",style:"rightClick",script(){game.loadPage(0)}}]}]}]},{title:"Un torrent qui s'enfuit",fluff:"Derrière {c:les arbres|bois}, une petite rivière clairette court entre les rochers moussus.",refBackground:function(){applyBackground({mid:"Soufflant_Plaine_Rivière_mid"})},scenes:[{story:()=>"journée"==time.period?"{c:L'eau chantante de la rivière|rivière} est transparente, et sur le bord, vous observez des têtards -tout sémillants dans l'onde fraîche- entamant l'aventure de la vie.":"crépuscule"==time.period?"{c:Le petit bras d'eau|rivière} reflète les derniers rayons du soleil, et sur le bord, vous observez des têtards -tout sémillants dans l'onde fraîchissante- entamant l'aventure de la vie.":"nuit"==time.period?"Vous devinez la masse sombre du court d'eau à peine un mètre avant de tomber dedans. Vous ne voyez pas grand chose d'autre que {c:de petits essaims de bégariannes|bégariannes}, qui semblent peu troublées par la profondeur de la nuit. Mais la lumière émise par ces insectes ne vous permettent pas de distinguer autre chose que vos pieds.":"aube"==time.period?"{c:L'eau chantante de la rivière|rivière} reflète les permiers rayons du soleil, et sur le bord, vous observez des têtards -tout sémillants dans l'onde fraîche- entamant l'aventure de la vie.":void 0,extras(){"nuit"!=time.period&&extraBlock("L'eau semble assez peu profonde et le courant assez faible pour traverser {c:vers l'autre rive|rive}.","path"),"nuit"==time.period&&extraBlock("Mieux vaudrait revenir ici de jour, vous ne voyez pas grand chose..","night"),extrasDB.time.long_soufflant()},triggers:[{trigText:"bois",showName:"le bois",RClick:function(){game.loadPage(1)},actions:[{name:"Revenir",style:"rightClick",script(){game.loadPage(1)}}]},{trigText:"rivière",showName:"la rivière",actions:[{name:"Observer",style:"normal",script(){modalList.Soufflant_Riviere_RegarderEau()}}]},{trigText:"rive",showName:"l'autre rive",actions:[{name:"Observer",style:"normal",script(){Events.rivièreTraversée?modalList.Soufflant_Riviere_LookRive_Traversée():modalList.Soufflant_Riviere_LookRive()}}]},{trigText:"bégariannes",showName:"les bégariannes",actions:[{name:"Observer",style:"normal",script(){modalList.Soufflant_Riviere_LookInsectes()}}]}]}]}];String.prototype.masculinize=function(){return this.replace(/\{f:+[^}]*\}/g,"").replace(/\{m:([^}]*)\}/g,"$1")},String.prototype.feminize=function(){return this.replace(/\{m:+[^}]*\}/g,"").replace(/\{f:([^}]*)\}/g,"$1")},String.prototype.genreIt=function(){return"m"==player.genre?this.masculinize():this.feminize()},String.prototype.setTrigs=function(){return this.replace(/\{c:([^}|]*)\}/g,"<a class='click' data-trigger='$1'>$1</a>").replace(/\{c:([^|]*)+\|([^}]*)\}/g,"<a class='click' data-trigger='$2'>$1</a>")},String.prototype.addLineBreaks=function(){return this.replace(/\/{2}/g,"<br>")},String.prototype.bold=function(){return this.replace(/\*+([^*]*)\*/g,"<strong>$1</strong>")},String.prototype.format=function(){return this.genreIt().setTrigs().addLineBreaks().bold()};var time={IRLsectoIGmin:1.5,hours:13,minutes:0,period:"journée",daysPlayed:0,set:function(e){void 0!==e.minutes&&(this.minutes=e.minutes,this.minutes>59&&this.set({hours:++this.hours,minutes:0})),void 0!==e.hours&&(this.hours=e.hours,(24>=this.hours&&this.hours>=21||4>=this.hours&&this.hours>=0)&&"nuit"!=time.period&&this.changePeriod("nuit"),9>=this.hours&&this.hours>=5&&"aube"!=time.period&&this.changePeriod("aube"),17>=this.hours&&this.hours>=10&&"journée"!=time.period&&this.changePeriod("journée"),20>=this.hours&&this.hours>=18&&"crépuscule"!=time.period&&this.changePeriod("crépuscule"),this.hours>23&&(this.set({hours:0}),this.daysPlayed++),game.refreshPage(),time.refreshClocks())},start:function(){time.changePeriod("journée"),time.refreshClocks(),setInterval(function(){time.set({minutes:++time.minutes}),time.refreshClocks()},1e3*time.IRLsectoIGmin)},formatDate:function(){return(this.hours<10?"0"+this.hours:this.hours)+":"+(this.minutes<10?"0"+this.minutes:this.minutes)},refreshClocks:function(){$("nav").html(time.formatDate())},changePeriod:function(e){"journée"==e&&(time.period="journée",$(".background").css("background-image","linear-gradient(to top, rgb(213, 232, 253) 75%, rgb(192, 210, 255))"),$(".sun").css({display:"","z-index":"",left:"",top:""}),$(".clouds.-back,.clouds.-front").css({filter:"",opacity:1}),$(".cover, .prop").css("filter",""),$(".stars").css("display","none"),$("main.main").removeClass("nightTheme")),"crépuscule"==e&&(time.period="crépuscule",$(".background").css("background-image","radial-gradient(circle at center bottom, rgb(255, 140, 108) 50%, rgb(68, 54, 65) 95%)"),$(".sun").css({display:"","z-index":1,top:"56vh",left:"37vw"}),$(".stars").css({display:"",opacity:"0.4"}),$(".clouds").css("filter","saturate(85.3%) brightness(29%) sepia(100%) contrast(127%) hue-rotate(-44deg)"),$(".cover, .prop").css("filter","saturate(100.3%) brightness(43%) sepia(52%) contrast(128%) hue-rotate(-52deg)"),$("main.main").addClass("nightTheme")),"nuit"==e&&(time.period="nuit",$(".background").css("background-image","linear-gradient(to top, rgb(22, 10, 30) 37%, rgb(0, 0, 0))"),$(".sun").css("display","none"),$(".stars").css({display:"",opacity:"1"}),$(".clouds.-back").css({filter:"saturate(85.3%) brightness(12%) sepia(100%) contrast(122%) hue-rotate(-125deg)",opacity:.3}),$(".clouds.-front").css({filter:"saturate(85.3%) brightness(12%) sepia(100%) contrast(122%) hue-rotate(-125deg)",opacity:.7}),$(".cover.-back").css("filter","saturate(79.3%) brightness(11%) sepia(100%) contrast(110%) hue-rotate(-119deg)"),$(".cover.-mid, .cover.-fore, .prop").css("filter","saturate(126.3%) brightness(13%) sepia(82%) contrast(104%) hue-rotate(-135deg)"),$("main.main").addClass("nightTheme")),"aube"==e&&(time.period="aube",$(".background").css("background-image","linear-gradient(to top, rgb(255, 170, 46) 28%, rgb(128, 129, 146))"),$(".sun").css("display","none"),$(".stars").css("display","none"),$(".clouds.-back").css({filter:"saturate(116%) brightness(40%) contrast(147%) hue-rotate(132deg)",opacity:.3}),$(".clouds.-front").css({filter:"saturate(116%) brightness(40%) contrast(147%) hue-rotate(132deg)",opacity:.7}),$(".cover.-back").css("filter","saturate(41.3%) brightness(33%) sepia(0%) contrast(100%) hue-rotate(9deg)"),$(".cover.-mid, .cover.-fore, .prop").css("filter","saturate(38.3%) brightness(52%) sepia(0%) contrast(113%) hue-rotate(-9deg)"),$("main.main").removeClass("nightTheme")),console.info(`TIME : période ${time.period}`)}};
//# sourceMappingURL=load.js.map