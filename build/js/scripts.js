function round(t,e){var n=Math.pow(10,e||0);return Math.round(t*n)/n}const random=(t,e)=>Math.floor(Math.random()*(e-t+1))+t,delay=(t,e,...n)=>setTimeout(t,e,...n);var player=new Player,bob=new NPC({name:"Bob",race:"Human",money:10});function toggle_color(t,e,n){var i=document.querySelector(t),r=i.style.backgroundColor;setTransitionDurations(i,n),i.style.backgroundColor=i.style.backgroundColor===r?e:r,console.log(i.style.backgroundColor)}function getStringFromMs(t){return t+"ms"}function setTransitionDurations(t,e){var n=getStringFromMs(e);["-webkit","-o","-moz"].forEach(function(e){t.style.setProperty(e+"-transition-duration",n)}),t.style.transitionDuration=n}function clickOnTrigger(t){var e=t.target;console.log(t);var n=game.scene.triggers;if(1===t.which){for(trigger in n)if(e.innerText==n[trigger].trigText)for(action in $("#actionmenu ul").html(""),$("#actionmenu header").html(`Actions sur <b>${n[trigger].showName}</b>`),n[trigger].actions)$("#actionmenu ul").append(`<li class="${n[trigger].actions[action].style}" onclick="game.scene.triggers[${trigger}].actions[${action}].script();">${n[trigger].actions[action].name}</li>`);$("#actionmenu").css({display:"block",left:t.pageX-parseInt($("#actionmenu").css("min-width"),10)/2,top:t.pageY+5,animation:"open-actionmenu .3s ease forwards"})}else if(3===t.which)for(trigger in n)e.innerText==n[trigger].trigText&&n[trigger].RClick&&n[trigger].RClick()}function rightClickOnTrigger(t){var e=t.target,n=game.scene.triggers;for(trigger in n)e.innerText==n[trigger].trigText&&n[trigger].RClick&&n[trigger].RClick()}time.start(),game.loadPage(0),chance={isShown:!1,show(){this.isShown||(overlay.show(),this.isShown=!0,$(".chance").css({display:"block",animation:"open-modal 0.3s ease forwards"})),delay(function(){dice.show()},400)},hide(){this.isShown&&(overlay.hide(),$(".chance").css("animation","close-modal 0.3s ease forwards"),delay(function(){$(".chance").css("display","none"),this.isShown=!1},300))},init(t){if(this.consq=t.consq,"difficulté"==t.type)var e=t.diff;t.type;var n={EcCr:[1,Math.round(e/3*20)-1],Ec:[Math.round(e/3*20),Math.round(20*e)-1],"Ré":[Math.round(20*e),Math.round(20*(e+(1-e)/3*2))-1],"RéCr":[Math.round(20*(e+(1-e)/3*2)),20]},i={EcCr:[],Ec:[],"Ré":[],"RéCr":[]};i.Ec=n.Ec,i.Ré=n.Ré,n.EcCr[1]<=1?n.Ec[0]<=1?(i.EcCr=!1,i.Ec[0]=1):i.EcCr=1:i.EcCr=n.EcCr,20<=n.RéCr[0]?20<=n.Ré[1]?(i.RéCr=!1,i.Ré[1]=20):n.Ré[1]<=n.Ré[0]&&20<=n.Ré[0]?i.RéCr=!1:i.RéCr=20:i.RéCr=n.RéCr,n.Ec[1]<=n.Ec[0]&&(i.Ec=n.Ec[0]),n.Ré[1]<=n.Ré[0]&&(i.Ré=n.Ré[0]),chance.resultGrid=i,$(".chance aside").html("");var r=chance.resultGrid,c=[r.EcCr,r.Ec,r.Ré,r.RéCr],a=["Échec critique","Échec","Réussite","Réussite critique"],o=["EcCr","Ec","Ré","RéCr"];for(let t in c)c[t]&&("number"==typeof c[t]&&$(".chance aside").append(`<div class='${o[t]} cat'><h2>${a[t]}</h2>${c[t]}`),"object"==typeof c[t]&&$(".chance aside").append(`<div class='${o[t]} cat'><h2>${a[t]}</h2>${c[t][0]} à ${c[t][1]}`));chance.show()},getResult(t){var e,n,i,r=chance.resultGrid,c={list:[r.EcCr,r.Ec,r.Ré,r.RéCr],txt:["Échec critique","Échec","Réussite","Réussite critique"],names:["EcCr","Ec","Ré","RéCr"]};for(cat in c.list)c.list[cat]&&("number"==typeof c.list[cat]&&t==c.list[cat]&&(e=c.txt[cat],n=c.names[cat]),"object"==typeof c.list[cat]&&c.list[cat][0]<=t&&t<=c.list[cat][1]&&(e=c.txt[cat],n=c.names[cat]));$(`.chance aside .${n}`).css("animation","chanceCatShine 3s ease forwards"),$(`.chance aside .${n} h2`).css("animation","chanceCatShine_h2 3s ease forwards"),i=chance.consq[n].txt?`<br> <i>${chance.consq[n].txt}`:"",new Notification({type:`test-${n}`,txt:`Test de chance : ${e}! ${i}`,timeOut:80}),delay(function(){chance.consq[n].script()},500),delay(function(){chance.hide()},3e3)}},function(){Element.prototype.sdrag=function(t,e,n){var i=0,r=0,c=this,a=!1;function o(e){var a={};if(t&&t(c,e.pageX,i,e.pageY,r,a),"vertical"!==n){var o="pageX"in a?a.pageX:e.pageX;"startX"in a&&(i=a.startX),0=="skipX"in a&&(c.style.left=o-i+"px")}if("horizontal"!==n){var s="pageY"in a?a.pageY:e.pageY;"startY"in a&&(r=a.startY),0=="skipY"in a&&(c.style.top=s-r+"px")}}this.addEventListener("mousedown",function(t){if(!(t.currentTarget instanceof HTMLElement||t.currentTarget instanceof SVGElement))throw new Error("Your target must be an html element");a=!0;var e=c.style.left?parseInt(c.style.left):0,n=c.style.top?parseInt(c.style.top):0;i=t.pageX-e,r=t.pageY-n,window.addEventListener("mousemove",o)}),window.addEventListener("mouseup",function(t){!0===a&&(a=!1,window.removeEventListener("mousemove",o),e&&e(c,t.pageX,i,t.pageY,r))})}}(),document.querySelectorAll("#actionmenu")[0].sdrag(),$(document).on("contextmenu",function(){return!1}),$("#actionmenu").on("click",function(t){t.stopPropagation(),$(t.target||t.srcElement).is("li")&&$("#actionmenu").css("display","")}),$(document).on("click",function(t){t.target!=$("#actionmenu")&&$("#actionmenu").css("display","")}),$(document).on("click",".click",function(t){t.stopPropagation(),clickOnTrigger(t)});
//# sourceMappingURL=scripts.js.map